<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" lang="zh-CN">
<!-- generated by to_html.pl from Transition.xml -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>关于转场效果</title>
	<meta name="author" content="W.Dee" />
	<meta http-equiv="Content-Style-Type" content="text/css" />
	<meta http-equiv="Content-Script-Type" content="text/javascript" />
	<link href="browser.css" type="text/css" rel="stylesheet" title="吉里吉里相关参考用标准样式" />
	<link href="mailto:dee@kikyou.info" rev="Made" />
	<link href="index.html" target="_top" rel="Start" title="首页" />
</head>
<body>
<h1><a id="id288" name="id288">什么是转场效果</a>
</h1><div class="para"><div>
　转场效果是指花费一定时间进行画面切换的效果。吉里吉里2的转场效果既可以应用于单个图层，也可以应用于图层树。<br />
　当为图层指定切换源时，将会切换两个图层。<br />
　前者是指相应的图层会切换，后者是指图层的树结构会完全切换。<br />
　请参考<a target="main" class="jump" href="f_Layer_beginTransition.html">Layer.beginTransition</a>方法。<br />
<br />
　吉里吉里2通过称为"<a id="id289" name="id289" class="targanchor"><dfn>转场处理器</dfn></a>"的机制管理转场效果。这些是在Layer.beginTransition方法的name参数中指定的，当前版本在吉里吉里本体内置了3个。也可以通过插件进行扩展。<br />
<br />
　以下将介绍吉里吉里本体内置的转场处理器以及可通过扩展转场插件(extrans.dll)使用的转场处理器。<br />
</div></div>
<h1><a id="id290" name="id290">选项的指定</a>
</h1><div class="para"><div>
<br />
<dl>
<dt>从TJS2使用的情况</dt>
<dd>　在Layer.beginTransition方法的options参数中以字典数组的形式指定。例如，要使用"universal"转场效果，并指定vague=100 time=2000 rule=rule1.png，则在options参数中如下指定：<br />
<br />
<code class="inlinecode">%[vague:100, time:2000, rule:"rule1.png"]</code></dd>
<dt>从KAG使用的情况</dt>
<dd>　在KAG中，可以直接在trans标签中以属性形式指定选项。但是，除了选项之外还有其他需要指定的属性(layer, children, method属性)。这些属性需要与选项一起指定。<br />
　例如，要对背景图层及其子图层应用vague=100 time=2000 rule=rule1.png的"universal"转场效果，可以如下指定：<br />
<br />
<code class="inlinecode">@trans layer=base children=true method=universal vague=100 time=2000 rule=rule1.png</code><br />
<br />
　另外，如果想使用"wave"转场效果并指定maxomega=0.1 maxh=20，可以如下指定：<br />
<br />
<code class="inlinecode">@trans layer=base children=true method=wave maxomega=0.1 maxh=20</code></dd></dl></div></div>
<h1><a id="id291" name="id291">内置转场处理器</a>
</h1><div class="para"><div>
　吉里吉里本体内置了以下3种转场处理器：<br />
<br />
<dl>
<dt><a id="id292" name="id292" class="targanchor"><dfn>crossfade</dfn></a></dt>
<dd>　"crossfade"转场效果(交叉淡入淡出转场)是最简单的转场效果，执行简单的交叉淡入淡出。<br />
　选项如下：<br />
<br />
<dl>
<dt>time (必须)</dt>
<dd>　以毫秒为单位指定转场执行的时间。</dd></dl></dd>
<dt><a id="id293" name="id293" class="targanchor"><dfn>universal</dfn></a></dt>
<dd>　"universal"转场效果(通用转场)是根据称为规则图像的灰度图像进行转场的效果。规则图像通过rule选项指定，图像中较暗的部分会更早地切换到切换源(在KAG中为背景画面)。<br />
　如果规则图像小于要执行转场的画面，则会以平铺方式填充；如果大于要执行转场的画面，则只使用左上部分。<br />
　KAG的参考文档中有详细说明。<br />
　选项如下：<br />
<br />
<dl>
<dt>time (必须)</dt>
<dd>　以毫秒为单位指定转场执行的时间。</dd>
<dt>rule (必须)</dt>
<dd>　指定规则图像文件名。规则图像必须是256级灰度图像。如果指定其他类型的图像，将强制转换为灰度图像。</dd>
<dt>vague</dt>
<dd>指定"模糊区域值"。指定较小的值(如0)时，画面切换前部分和切换后部分的边界会很清晰。指定较大的值(如128)时，边界会变得模糊，更加平滑。最佳值取决于规则图像。省略时默认为64。</dd></dl></dd>
<dt><a id="id294" name="id294" class="targanchor"><dfn>scroll</dfn></a></dt>
<dd>　"scroll"转场效果(滚动转场)是通过滑动切换源或切换目标(或两者)来产生滚动效果的转场。<br />
　选项如下：<br />
<br />
<dl>
<dt>time (必须)</dt>
<dd>　以毫秒为单位指定转场执行的时间。</dd>
<dt>from</dt>
<dd>　指定切换源(在KAG中为背景页面)图层从哪个方向出现。<br />
　在TJS中指定时，指定sttLeft表示从左侧出现(默认)，sttTop表示从上方出现，sttRight表示从右侧出现，sttBottom表示从下方出现。<br />
　在KAG的trans标签中指定时，指定"left"表示从左侧出现(默认)，"top"表示从上方出现，"right"表示从右侧出现，"bottom"表示从下方出现。</dd>
<dt>stay</dt>
<dd>　指定切换源和切换目标图像如何移动。<br />
　在TJS中指定时，指定ststNoStay表示切换目标图像会被切换源图像推出(默认)，可以产生两个画面连接滚动的效果。指定ststStaySrc表示切换目标图像移出，其背后显示出切换源图像。指定ststStayDest表示切换目标图像保持静止，切换源图像进入其中。<br />
　在KAG中指定时，"nostay"对应ststNoStay，"stayback"对应ststStaySrc，"stayfore"对应ststStayDest。</dd></dl></dd></dl></div></div>

<h1><a id="id295" name="id295">扩展转场插件</a>
</h1><div class="para"><div>
　扩展转场插件(extrans.dll)是吉里吉里2的插件，可以使用几种本体内未内置的转场效果。<br />
　要使用这些效果，需要像其他插件一样，通过<a target="main" class="jump" href="f_Plugins_link.html">Plugins.link</a>方法连接(KAG中使用loadplugin标签)。连接后即可使用以下转场处理器：<br />
<br />
<dl>
<dt>wave</dt>
<dd>"wave"(波浪)转场是通过光栅滚动表现波浪效果进行切换的转场。<br />
<br />
<img width="320" height="240" alt="wave_trans.jpg" src="wave_trans.jpg" /><br />
<br />
　以下是可用选项：<br />
<br />
<dl>
<dt>time (必须)</dt>
<dd>　以毫秒为单位指定转场执行的时间。</dd>
<dt>wavetype</dt>
<dd>　指定波浪的动作。指定0时，转场的开始和结束时波浪细腻，中间波浪变得柔和。指定1时，开始波浪细腻，逐渐变得柔和。指定2时，开始波浪柔和，逐渐变得细腻。默认为0。</dd>
<dt>maxh</dt>
<dd>　以像素为单位指定波浪横向宽度的最大值。值越大，波浪的凹凸越深。默认为50。</dd>
<dt>maxomega</dt>
<dd>　指定波浪角速度(rad/pixel)的最大值。值越大，波浪越细腻。值越小，波浪越柔和。默认为0.2。</dd>
<dt>bgcolor1</dt>
<dd>　以0xRRGGBB格式指定初始背景色。</dd>
<dt>bgcolor2</dt>
<dd>　以0xRRGGBB格式指定最终背景色。背景色从初始背景色开始，逐渐变为最终背景色。</dd></dl></dd>

<dt>mosaic</dt>
<dd>"mosaic"(马赛克)转场是表现矩形马赛克效果的转场。<br />
<br />
<img width="320" height="240" alt="mosaic_trans.png" src="mosaic_trans.png" /><br />
<br />
　以下是可用选项：<br />
<br />
<dl>
<dt>time (必须)</dt>
<dd>　以毫秒为单位指定转场执行的时间。</dd>
<dt>maxsize</dt>
<dd>　指定马赛克矩形大小的最大值。默认为30。值越大，马赛克越粗糙。</dd></dl></dd>

<dt>turn</dt>
<dd>"turn"转场是表现多个小卡片翻转的转场效果。<br />
<br />
<img width="320" height="240" alt="turn_trans.jpg" src="turn_trans.jpg" /><br />
<br />
　以下是可用选项：<br />
<br />
<dl>
<dt>time (必须)</dt>
<dd>　以毫秒为单位指定转场执行的时间。</dd>
<dt>bgcolor</dt>
<dd>　以0xRRGGBB格式指定背景色。</dd></dl></dd>

<dt>rotatezoom</dt>
<dd>"rotatezoom"转场是将转场源(KAG中的背景画面)旋转并同时放大或缩小的转场效果。<br />
<br />
<img width="320" height="240" alt="rotatezoom_trans.jpg" src="rotatezoom_trans.jpg" /><br />
<br />
　以下是可用选项：<br />
<br />
<dl>
<dt>time (必须)</dt>
<dd>　以毫秒为单位指定转场执行的时间。</dd>
<dt>factor</dt>
<dd>　指定初始缩放比例。指定0时，最初不可见，从中心旋转放大。指定2时，从2倍大小旋转缩小到原始大小。也可以指定3或更大的数字或实数。默认为1(原始大小)。</dd>
<dt>accel</dt>
<dd>　指定放大缩小的加速度动作。指定-2或更小的负数时，开始快，逐渐变慢。指定2或更大的正数时，开始慢，逐渐变快。指定0时为线性动作，但视觉效果可能不会显得线性。默认为0。</dd>
<dt>twist</dt>
<dd>　指定旋转方向和旋转量。指定正数时，逆时针旋转。指定负数时，顺时针旋转。值表示旋转圈数。默认为2。</dd>
<dt>twistaccel</dt>
<dd>　指定旋转的加速度动作。指定-2或更小的负数时，开始快，逐渐变慢。指定2或更大的正数时，开始慢，逐渐变快。指定0时为线性动作。默认为-2。</dd></dl></dd>

<dt>rotatevanish</dt>
<dd>"rotatevanish"转场是将转场目标(KAG中的表画面)旋转并缩小的转场效果。<br />
<br />
<img width="320" height="240" alt="rotatevanish_trans.jpg" src="rotatevanish_trans.jpg" /><br />
<br />
　以下是可用选项：<br />
<br />
<dl>
<dt>time (必须)</dt>
<dd>　以毫秒为单位指定转场执行的时间。</dd>
<dt>accel</dt>
<dd>　指定放大缩小的加速度动作。指定-2或更小的负数时，开始快，逐渐变慢。指定2或更大的正数时，开始慢，逐渐变快。指定0时为线性动作，但视觉效果可能不会显得线性。默认为2。</dd>
<dt>twist</dt>
<dd>　指定旋转方向和旋转量。指定正数时，逆时针旋转。指定负数时，顺时针旋转。值表示旋转圈数。默认为2。</dd>
<dt>twistaccel</dt>
<dd>　指定旋转的加速度动作。指定-2或更小的负数时，开始快，逐渐变慢。指定2或更大的正数时，开始慢，逐渐变快。指定0时为线性动作。默认为2。</dd></dl></dd>

<dt>rotateswap</dt>
<dd>"rotateswap"转场是旋转切换转场目标和转场源的转场效果。转场目标(KAG中的表画面)旋转到后方，转场源(KAG中的背景画面)旋转到前方。<br />
<br />
<img width="320" height="240" alt="rotateswap_trans.jpg" src="rotateswap_trans.jpg" /><br />
<br />
　以下是可用选项：<br />
<br />
<dl>
<dt>time (必须)</dt>
<dd>　以毫秒为单位指定转场执行的时间。</dd>
<dt>twist</dt>
<dd>　指定旋转方向和旋转量。指定正数时，逆时针旋转。指定负数时，顺时针旋转。值表示旋转圈数。默认为1。</dd>
<dt>bgcolor</dt>
<dd>　以0xRRGGBB格式指定背景色。</dd></dl></dd>

<dt>ripple</dt>
<dd>"ripple"转场是展现波纹扩散效果的转场。<br />
<br />
<img width="320" height="240" alt="ripple_trans.jpg" src="ripple_trans.jpg" /><br />
<br />
　以下是可用选项：<br />
<br />
<dl>
<dt>time (必须)</dt>
<dd>　以毫秒为单位指定转场执行的时间。</dd>
<dt>centerx</dt>
<dd>　指定波纹中心的X坐标。省略时默认为图像中心。</dd>
<dt>centery</dt>
<dd>　指定波纹中心的Y坐标。省略时默认为图像中心。</dd>
<dt>rwidth</dt>
<dd>　指定波纹的细腻程度。可以指定16、32、64、128中的一个值，数值越小波纹越细腻。省略时默认为128。</dd>
<dt>roundness</dt>
<dd>　指定波纹是垂直长椭圆、正圆还是水平长椭圆。指定0.0到1.0(不包括0.0)之间的值(如0.5)时，波纹为垂直长椭圆。指定1.0时为正圆。指定大于1.0的值(如2)时，波纹为水平长椭圆。省略时默认为1.0。</dd>
<dt>speed</dt>
<dd>　指定波纹扩散的速度。省略时默认为6.0。</dd>
<dt>maxdrift</dt>
<dd>　指定波纹的剧烈程度。省略时默认为24。</dd></dl><br />
<br /><div class="note"><div class="notehead"><span class="noteheadspan">注意</span></div>
　ripple转场在首次执行时，会分配相当大的内存(根据选项不同，约0.5～4MB)，预先完成平滑转场所需的数值计算，并存储在该内存中。
这可能会花费一些时间(约0.01秒～0.5秒)。<br />
　如果执行转场的图像大小、centerx、centery、rwidth、roundness、maxdrift等条件完全相同，则会重用之前的数值计算信息。系统会保留(缓存)
最近4组条件的数值计算结果。如果需要对更多新条件进行数值计算，则会从最旧的信息开始删除。<br />
　考虑到这一点，如果经常使用此转场效果，建议在实际使用前先执行一次虚拟转场，以避免后续的数值计算。<br />
</div><br />
</dd></dl><br />

</div></div>
	<script type="text/javascript" charset="UTF-8" src="documentid.js" ></script>
	<script type="text/javascript" charset="UTF-8" src="postcontent.js" ></script>
</body>
</html>
