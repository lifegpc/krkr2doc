<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" lang="zh-CN">
<!-- generated by to_html.pl from DispLayer.xml -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>显示前景</title>
	<meta name="author" content="W.Dee" />
	<meta http-equiv="Content-Style-Type" content="text/css" />
	<meta http-equiv="Content-Script-Type" content="text/javascript" />
	<link href="browser.css" type="text/css" rel="stylesheet" title="吉里吉里相关参考用标准样式" />
	<link href="mailto:dee@kikyou.info" rev="Made" />
	<link href="index.html" target="_top" rel="Start" title="首页" />
</head>
<body>
<h1><a id="id34" name="id34">什么是前景</a>
</h1><div class="para"><div>
　前景是指...简单来说，就是显示在背景和消息之间的内容，比如人物的立绘等。KAG标准支持最多叠加3层前景（通过自定义可以叠加更多层）。<br />
<br />
　前景为了按照人物等形状裁剪图像显示，会使用遮罩或者颜色键等技术。KAG支持使用遮罩显示前景和使用颜色键显示图像两种方法，对于PNG、ERI或TLG5/TLG6等包含Alpha通道或透明信息的图像格式，可以使用图像自身的透明方式进行透明处理。<br />
</div></div>
<h1><a id="id35" name="id35">使用颜色键的前景</a>
</h1><div class="para"><div>
　颜色键是指，将应该透明的部分用特定的颜色填充，使该颜色部分变为透明的技术。<br />
　全彩色图像和256色或16色图像在处理上有些不同。<br />
<br />
　在全彩色图像的情况下，就是选择一个"看起来不会被使用"的颜色作为"<a id="id36" name="id36" class="targanchor"><dfn>透明色</dfn></a>"（颜色键），然后用它填充想要透明的部分。常用的不太可能被使用的颜色有纯品红(r,g,b)=(255,0,255)或纯绿色(r,g,b)=(0,255,0)。<br />
　但如果你想要表现品红或绿色怎么办呢？可以使用类似(r,g,b)=(254,0,255)或(r,g,b)=(0,254,0)的颜色，在KAG中这些会被处理为不同的颜色，所以没问题。<br />
<br />
　在256色或16色图像中，会使用某一个特定的<a id="id37" name="id37" class="targanchor"><dfn>调色板索引</dfn></a>作为"透明色"。用这个调色板索引填充的部分会变成透明的。<br />
<br />
<br /><div class="note"><div class="notehead"><span class="noteheadspan">注意</span></div>
　对于PNG等图像格式，有些软件在保存时可以指定<a id="id38" name="id38" class="targanchor"><dfn>透明色</dfn></a>（颜色键），使用这类软件输出的PNG图像也可以正常处理。</div><br />
<br />
<br /><div class="descimg"><img width="48" height="12" alt="ButtonGlyphImageList.png" src="ButtonGlyphImageList.png" /><br />透明色示例</div><br /></div></div>
<h1><a id="id39" name="id39">使用遮罩的前景</a>
</h1><div class="para"><div>
　在KAG中，可以准备一个与普通前景图像不同的遮罩图像，根据这个遮罩图像来裁剪前景图像进行显示。<br />
<br />
　<a id="id40" name="id40" class="targanchor"><dfn>遮罩图像</dfn></a>是与前景图像相同大小的256级灰度图像，亮度直接表示"不透明度"。也就是说，亮度为0的部分是"完全透明"，亮度为255的部分是"完全不透明"。亮度在128左右的部分则是"半透明"。应该显示的部分是白色，透明部分是黑色的图像。<br />
　遮罩图像必须以256级灰度（256色图像）格式保存。如果以全彩色或16色保存，将无法正常显示。<br />
　遮罩图像保存的是不透明度信息，而与之对应的前景图像则保存颜色信息。在这种情况下，前景图像特别称为<a id="id41" name="id41" class="targanchor"><dfn>主图像</dfn></a>。<br />
<br /><div class="note"><div class="notehead"><span class="noteheadspan">注意</span></div>
　对于PNG、ERI或TLG5/TLG6格式的图像，可以在一个PNG/ERI/TLG5文件中包含<a id="id42" name="id42" class="targanchor"><dfn>Alpha通道</dfn></a>（即遮罩图像）。<br />
　如果您有可以输出这类图像的软件（对于PNG，如GIMP等），就不需要另外准备遮罩文件。另外，使用吉里吉里SDK附带的图像格式转换器可以简单地进行这些图像格式的转换。</div><br />
<br />
　遮罩图像的保存名称是在主图像文件名后添加_m。例如，如果主图像是hogehoge.png，那么它的遮罩图像就是hogehoge_m.png。这种主图像和遮罩图像分离的形式称为主/遮罩分离形式。<br />
<br />
　使用遮罩图像的优点是，叠加前景时可以自由指定不透明度，并且使用适当处理的遮罩图像和主图像，可以在叠加时使边缘呈现漂亮的抗锯齿状态。<br />
<br /><div class="descimg"><img width="312" height="380" alt="ayari.png" src="ayari.png" /><img width="312" height="380" alt="ayari_m.png" src="ayari_m.png" /><br />遮罩示例（左图为主图像，右图为遮罩）</div><br /></div></div>
<h1><a id="id43" name="id43">显示前景</a>
</h1><div class="para"><div>
　按照以上说明，请准备适当的图像（请自行准备图像...）。首先，从使用颜色键的前景显示方法开始...<br />

<br />
<code class="bq">[image&nbsp;storage=&quot;bg0&quot;&nbsp;page=fore&nbsp;layer=base]<br />
[wait&nbsp;time=200]<br />
*start|开始<br />
[cm]<br />
<em>[image&nbsp;layer=0&nbsp;page=fore&nbsp;storage=&quot;as&quot;&nbsp;visible=true&nbsp;key=0xff00ff&nbsp;left=340&nbsp;top=100]</em><br />
你好。<br />
</code>
<br />

　粗体显示的部分是显示前景图像的部分。<a id="id44" name="id44" class="targanchor"><dfn>image</dfn></a>标签在<a target="main" class="jump" href="DispBase.html">显示背景</a>一节中也出现过。它是用于加载图像的标签。这里把layer设为0，指定前景层的0号。<br />
　这里有一个key属性。key属性用于指定透明色。像这样用0xRRGGBB格式的16进制数指定透明色时，会把填充了RR(红)GG(绿)BB(蓝)颜色的部分作为透明色处理。例如，key=0xff00ff指定(r,g,b)=(255,0,255)即纯品红作为透明色。如果指定key=255，则key表示使用调色板索引255作为颜色键。详细信息请参考<a target="main" class="jump" href="Tags.html">标签参考</a>。<br />
<br />
　这里写了storage=&quot;as&quot;，表示加载名为as的图像。不需要指定扩展名。在这种情况下，会自动查找并加载名为as的可读取图像文件。<br />
<br />
　指定visible=true是因为KAG的前景层默认都是不可见的，所以在这里设置为显示才能看到。<br />
<br />
　left=340 top=100指定了前景层的左边缘位置和上边缘位置。前景层可以在image标签加载时指定显示位置。<br />
<br /><div class="note"><div class="notehead"><span class="noteheadspan">注意</span></div>
　PNG图像中的显示偏移指定会被忽略。</div><br />
<br />
　使用遮罩图像时，指定方式如下：<br />

<br />
<code class="bq">[image&nbsp;storage=&quot;bg0&quot;&nbsp;page=fore&nbsp;layer=base]<br />
[wait&nbsp;time=200]<br />
*start|开始<br />
[cm]<br />
<em>[image&nbsp;layer=0&nbsp;page=fore&nbsp;storage=&quot;asm&quot;&nbsp;visible=true&nbsp;left=340&nbsp;top=100]</em><br />
你好。<br />
</code>
<br />

　只是没有key属性而已。<br />
　在这个例子中，asm_m作为遮罩图像，asm作为主图像被加载。<br />
<br />
　对于PNG等可以在图像中包含Alpha通道信息或颜色键的图像格式，与上例相同，不需要指定key属性。<br />
<br /><div class="descimg"><img width="325" height="265" alt="LayerDisplayed.jpg" src="LayerDisplayed.jpg" /><br />执行结果</div><br /></div></div>
	<script type="text/javascript" charset="UTF-8" src="documentid.js" ></script>
	<script type="text/javascript" charset="UTF-8" src="postcontent.js" ></script>
</body>
</html>
