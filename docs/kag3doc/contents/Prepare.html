<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" lang="zh-CN">
<!-- generated by to_html.pl from Prepare.xml -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>准备工作</title>
	<meta name="author" content="W.Dee" />
	<meta http-equiv="Content-Style-Type" content="text/css" />
	<meta http-equiv="Content-Script-Type" content="text/javascript" />
	<link href="browser.css" type="text/css" rel="stylesheet" title="吉里吉里相关参考用标准样式" />
	<link href="mailto:dee@kikyou.info" rev="Made" />
	<link href="index.html" target="_top" rel="Start" title="首页" />
</head>
<body>
<h1><a id="id129" name="id129">准备工作</a>
</h1><div class="para"><div>
　首先，在吉里吉里SDK文件夹（<code class="inlinecode">krkr.eXe</code>所在位置）下创建一个项目名称的文件夹。项目名称可以随意取。但是，请避免使用"<code class="inlinecode">data</code>"作为文件夹名（只有在需要分发时才将<code class="inlinecode">data</code>作为文件夹名）。我们称这个文件夹为<a id="id130" name="id130" class="targanchor"><dfn>项目文件夹</dfn></a>。<br />
<br />
　然后，将KAG系统复制到该文件夹下。下载的KAG的LZH文件解压后应该有一个名为<code class="inlinecode">template</code>的文件夹。将其<em>内容</em>（不是<code class="inlinecode">template</code>文件夹本身）复制到项目文件夹中。<br />
<br />
　布局如下：<br />
<br /><div class="descimg"><img width="314" height="275" alt="Folders.png" src="Folders.png" /><br />复制文件后</div><br />　然后，在<code class="inlinecode">system</code>文件夹中有一个<code class="inlinecode">Config.~new</code>文件，请将其重命名为<code class="inlinecode"><a id="id131" name="id131" class="targanchor"><dfn>Config.tjs</dfn></a></code>。之后，用文本编辑器打开<code class="inlinecode">Config.tjs</code>。<br />
<br />
<br />
　<code class="inlinecode">Config.tjs</code>中还有许多其他需要设置的地方，之后可能会需要修改。详细说明请参阅<code class="inlinecode">Config.tjs</code>内的内容。<br />
<br />
<br />
　另外，在复制的文件夹中可能存在"～此文件可以删除～"之类的文件，这些是为了防止某些解压软件不展开空文件夹而放置的虚拟文件。可以删除（保留也不会有特别问题）。<br />
<br /><div class="note"><div class="notehead"><span class="noteheadspan">Note</span></div>
　更新KAG时，基本上只需要将新KAG的<code class="inlinecode">system</code>文件夹内容覆盖到现有的<code class="inlinecode">system</code>文件夹即可。首次运行时会自动继承旧<code class="inlinecode">Config.tjs</code>的设置，请按照屏幕提示操作。<br />
</div><br />
</div></div>
<h1><a id="id132" name="id132">文件夹说明</a>
</h1><div class="para"><div>
　复制时，会一同复制几个文件夹。下面对各文件夹进行说明。<br />
　实际上不必完全按照这些文件夹来组织，但如果改变文件夹布局，可能需要修改<code class="inlinecode"><a id="id133" name="id133" class="targanchor"><dfn>Initialise.tjs</dfn></a></code>的内容。详情请查看<code class="inlinecode">Initialise.tjs</code>的内容（.tjs文件是文本文件，可以用文本编辑器打开）。<br />
　另外，不论将什么放在这些文件夹中，在KAG的文件指定中都不需要指定文件夹名。即使在<code class="inlinecode">bgimage</code>文件夹中放MIDI文件也没问题。这些预先创建的文件夹只是为了方便<code class="inlinecode">(^^)</code><br />
<br />
　这些文件夹即使为空也不会有问题。不需要的文件夹可以删除。<br />
<br />
<dl>
<dt><img width="16" height="16" alt="folder.png" src="folder.png" /> <a id="id134" name="id134" class="targanchor"><dfn>system文件夹</dfn></a></dt>
<dd>　<code class="inlinecode">system</code>文件夹包含KAG运行所需的系统。</dd>
<dt><img width="16" height="16" alt="folder.png" src="folder.png" /> <a id="id135" name="id135" class="targanchor"><dfn>scenario文件夹</dfn></a></dt>
<dd>　<code class="inlinecode">scenario</code>文件夹用于存放剧本文件。剧本文件是在KAG中指定屏幕上显示文本、使用标签嵌入指示显示哪些图像等的扩展名为.ks的文件。<br />
　顺便说一下，启动吉里吉里时指定的是"项目文件夹"而不是单个剧本文件。</dd>
<dt><img width="16" height="16" alt="folder.png" src="folder.png" /> <a id="id136" name="id136" class="targanchor"><dfn>bgimage文件夹</dfn></a></dt>
<dd>　用于存放显示的背景图像的文件夹。</dd>
<dt><img width="16" height="16" alt="folder.png" src="folder.png" /> <a id="id137" name="id137" class="targanchor"><dfn>fgimage文件夹</dfn></a></dt>
<dd>　用于存放显示的前景图像（如角色立绘等）的文件夹。</dd>
<dt><img width="16" height="16" alt="folder.png" src="folder.png" /> <a id="id138" name="id138" class="targanchor"><dfn>image文件夹</dfn></a></dt>
<dd>　用于存放其他图像（如单幅图画）的文件夹。</dd>
<dt><img width="16" height="16" alt="folder.png" src="folder.png" /> <a id="id139" name="id139" class="targanchor"><dfn>bgm文件夹</dfn></a></dt>
<dd>　用于存放BGM（背景音乐）数据的文件夹。</dd>
<dt><img width="16" height="16" alt="folder.png" src="folder.png" /> <a id="id140" name="id140" class="targanchor"><dfn>sound文件夹</dfn></a></dt>
<dd>　用于存放音效数据的文件夹。</dd>
<dt><img width="16" height="16" alt="folder.png" src="folder.png" /> <a id="id141" name="id141" class="targanchor"><dfn>rule文件夹</dfn></a></dt>
<dd>　用于存放通用转场规则图像的文件夹。</dd>
<dt><img width="16" height="16" alt="folder.png" src="folder.png" /> <a id="id142" name="id142" class="targanchor"><dfn>others文件夹</dfn></a></dt>
<dd>　其他。</dd>
<dt><img width="16" height="16" alt="folder.png" src="folder.png" /> <a id="id143" name="id143" class="targanchor"><dfn>video文件夹</dfn></a></dt>
<dd>　用于存放视频文件。</dd></dl></div></div>
<h1><a id="id144" name="id144">支持的图像格式</a>
</h1><div class="para"><div>
　KAG（或者说吉里吉里）支持的图像格式如下：<br />
　也请参阅<a target="main" class="jump" href="GraphicFormats.html">关于图像格式</a>。<br />
<br />
<dl>
<dt><a id="id145" name="id145" class="targanchor"><dfn>BMP图像</dfn></a></dt>
<dd>　扩展名为.bmp或.dib。吉里吉里仅支持无压缩的BMP。<br />
　32位（32bpp）BMP被视为带Alpha通道的位图。</dd>
<dt><a id="id146" name="id146" class="targanchor"><dfn>JPEG图像</dfn></a></dt>
<dd>　扩展名为.jpeg或.jpg。可以处理各种图形工具输出的JPEG图像。</dd>
<dt><a id="id147" name="id147" class="targanchor"><dfn>便携式网络图形</dfn></a>（<a id="id148" name="id148" class="targanchor"><dfn>PNG图像</dfn></a>）</dt>
<dd>　扩展名为.png。可以由各种图形工具输出。支持Alpha通道和透明色指定。</dd>
<dt><a id="id149" name="id149" class="targanchor"><dfn>Entis栅格图像格式</dfn></a>（<a id="id150" name="id150" class="targanchor"><dfn>ERI图像</dfn></a>）</dt>
<dd>　扩展名为.eri。这是由Leshade Entis开发和设计的无损图像压缩技术和格式。通称"惠理酱"。<br />
　图像转换器等实用工具可以从"惠理酱club"<a target="_top" class="jump" href="http://www.entis.jp/eri/">http://www.entis.gr.jp/eri/</a>获取。<br />
<br />
　使用此图像压缩格式时，<em>特别</em>需要注意版权相关问题。详情请参阅吉里吉里SDK帮助中的"使用条件等"和上述"惠理酱club"。</dd>
<dt><a id="id151" name="id151" class="targanchor"><dfn>TLG5图像</dfn></a></dt>
<dd>　扩展名为.tlg（而非.tlg5）。这是吉里吉里独有的无损图像压缩格式，特点是可以快速解压。支持全彩图像和带Alpha通道的全彩图像。</dd>
<dt><a id="id152" name="id152" class="targanchor"><dfn>TLG6图像</dfn></a></dt>
<dd>　扩展名为.tlg（而非.tlg6）。这是吉里吉里独有的无损图像压缩格式，特点是高压缩率和相对较快的解压速度。支持全彩图像和带Alpha通道的全彩图像。</dd>
<dt>其他图像</dt>
<dd>　使用<a id="id153" name="id153" class="targanchor"><dfn>Susie插件</dfn></a>可以支持除以上格式外的其他图像格式。Susie插件应放置在吉里吉里可执行文件krkr.eXe同一文件夹中，或其下的<code class="inlinecode">plugin</code>文件夹中，或项目文件夹中。（此外，请参阅后述的"关于插件"）</dd></dl></div></div>
<h1><a id="id154" name="id154">支持的音频格式</a>
</h1><div class="para"><div>
<br />
　KAG（或者说吉里吉里）支持的音频格式如下：<br />
　音效只能使用PCM。<br />
　根据BGM使用的格式，可能需要修改KAG的Config.tjs。详情请查看Config.tjs的内容。<br />
<br />
<dl>
<dt><a id="id155" name="id155" class="targanchor"><dfn>PCM</dfn></a></dt>
<dd>　标准情况下，可以播放无压缩的RIFF-WAVE（扩展名为.wav）。<br />
<br />
　除无压缩的RIFF-WAVE外，还可以播放Ogg Vorbis（*.ogg）、TCWF（*.tcw）、Microsoft ADPCM（*.wav）等，但需要插件。<br />
　吉里吉里2发行包中附带了Ogg Vorbis用（wuvorbis.dll）、TCWF用（wutcwf.dll）、Microsoft ADPCM用（wumsadp.dll）插件。<br />
<br />
　Ogg Vorbis是一种无专利费的压缩音乐格式，可以像MP3一样使用。编码器可以从<a target="_top" class="jump" href="http://www.vorbis.com/">http://www.vorbis.com/</a>获取。<br />
<br />
　还可以使用其他插件（如果有的话）增加可播放的格式。关于插件，除了各插件的说明书外，请参阅后述的"关于插件"。<br />
<br />
　对于无压缩Wave、Ogg Vorbis、TCWF、Microsoft ADPCM各格式，可以使用Loop Tuner（可从支持页面获取）创建循环信息，从而精确指定循环位置。这样可以实现无缝循环播放。</dd>
<dt><a id="id156" name="id156" class="targanchor"><dfn>MIDI序列数据</dfn></a></dt>
<dd>　可以播放标准MIDI格式（扩展名为.smf或.mid）。进行交叉淡入淡出时需要特别注意，详情请参阅吉里吉里SDK帮助中的"关于MIDI音频缓冲区"。</dd>
<dt><a id="id157" name="id157" class="targanchor"><dfn>CD-DA</dfn></a></dt>
<dd>　可以播放<a id="id158" name="id158" class="targanchor"><dfn>CD-XA</dfn></a>的CD-DA部分。CD-XA是一种CD格式，其中计算机数据作为CD-ROM和音频数据作为CD-DA共存。吉里吉里使用CD-ROM上计算机数据部分的卷标来搜索可用的CD-ROM驱动器，因此只能处理CD-XA格式的CD。（当然，如果像本教程中所做的那样明确指定驱动器名称，则可以播放...）</dd></dl></div></div>
<h1><a id="id159" name="id159">支持的视频格式</a>
</h1><div class="para"><div>
<dl>
<dt><a id="id160" name="id160" class="targanchor"><dfn>MPEG I</dfn></a></dt>
<dd>　支持一般的MPEG I。<br />
　但是，分发时需要将<a id="id161" name="id161" class="targanchor"><dfn>krmovie.dll</dfn></a>放在与吉里吉里可执行文件相同的位置。另外，播放视频需要在播放环境中安装DirectX 8。<br />
<br /><div class="note"><div class="notehead"><span class="noteheadspan">Note</span></div>
　没有与音频多路复用的纯视频MPEG I流的扩展名应为.mpv而非.mpeg/.mpg。吉里吉里通过扩展名判断视频格式。<br />
</div><br />
</dd>
<dt><a id="id162" name="id162" class="targanchor"><dfn>WMV</dfn></a></dt>
<dd>　支持WMV。<br />
　可播放的WMV版本取决于系统上安装的Media Player或DirectX，但建议安装DirectX 9或更高版本的环境。</dd></dl><br /><div class="note"><div class="notehead"><span class="noteheadspan">Note</span></div>
　即使视频存储在用Releaser创建的档案或可执行文件中，吉里吉里也能直接从档案中播放视频（不通过临时文件）。但是，在Releaser中，视频文件需要分类为"不压缩"（在默认分类中会自动设置为不压缩）。<br />
</div><br />
<br /><div class="note"><div class="notehead"><span class="noteheadspan">Note</span></div>
　AVI格式视频不受支持。</div><br />
</div></div>
<h1><a id="id163" name="id163">Flash</a>
</h1><div class="para"><div>
<dl>
<dt><a id="id164" name="id164" class="targanchor"><dfn>SWF</dfn></a></dt>
<dd>　支持播放Macromedia Flash。<br />
　但是，分发时需要将<a id="id165" name="id165" class="targanchor"><dfn>krflash.dll</dfn></a>放在与吉里吉里可执行文件相同的位置。另外，播放SWF需要安装Flash Player。<br />
　Flash的播放方式与视频相同。</dd></dl><br /><div class="note"><div class="notehead"><span class="noteheadspan">Note</span></div>
　对Flash的支持不是完整的。需要键盘输入的Flash内容可能无法正常工作。此外，如果SWF文件存储在XP3等档案中，会先写入临时文件再使用，因此建议不要将大型SWF文件（超过3-5MB）存储在档案中。<br />
</div><br />
<br /><div class="note"><div class="notehead"><span class="noteheadspan">Note</span></div>
　作者没有Flash制作环境所以未经测试，但Flash内容可以控制KAG剧本跳转到任意标签。在Action Get URL（URL显示动作）中，将URL指定为<code class="inlinecode"><em>FSCommand:Go</em></code>，目标窗口指定为"剧本文件/标签"格式的字符串（例如：<code class="inlinecode"><em>first.ks/label2</em></code>）<br />
　通过<code class="inlinecode"><em>FSCommand:Eval</em></code>，将目标窗口指定为TJS表达式，可以在动作发生时执行任意TJS表达式（如给变量赋值）。<br />
　在openvideo标签或playvideo标签中，storage属性在文件名后添加?，然后可以指定传递给Flash的参数（例如：<code class="inlinecode">hoge.swf?name=value&amp;param=content</code>）。<br />
</div><br />
</div></div>


<h1><a id="id166" name="id166">支持的档案格式</a>
</h1><div class="para"><div>
<dl>
<dt><a id="id167" name="id167" class="targanchor"><dfn>XP3</dfn></a>和<a id="id168" name="id168" class="targanchor"><dfn>PEXP3</dfn></a></dt>
<dd>　可以处理吉里吉里独有的档案格式XP3。<br />
　PEXP3是"吉里吉里可执行文件"与XP3格式结合的形式，可以将作品整合到单个可执行文件中。<br />
　这两种格式都可以用吉里吉里SDK附带的Releaser创建。</dd>
<dt>其他档案格式</dt>
<dd>　使用<a id="id169" name="id169" class="targanchor"><dfn>Susie插件</dfn></a>可以支持除以上格式外的其他档案格式。（请参阅后述的"关于插件"）</dd></dl></div></div>


<h1><a id="id170" name="id170">预渲染字体</a>
</h1><div class="para"><div>
　预渲染字体是由制作者创建的字体数据。使用它可以始终以制作者预期的字体显示，不受OS和环境影响。还可以自由使用外字。<br />
　预渲染字体通过<a id="id171" name="id171" class="targanchor"><dfn>krkrfont.exe</dfn></a>创建。创建时，用于竖排显示的字体名称前应加上@符号。<br />
<br />
　预渲染字体文件扩展名为.tft。使用时，将其放在others等文件夹中，然后使用mappfont标签分配给任意字体。<br />
<br />
<br /><div class="note"><div class="notehead"><span class="noteheadspan">Note</span></div>
　预渲染字体创建工具的使用方法请参阅吉里吉里SDK帮助。<br />
</div><br />
</div></div>
<h1><a id="id172" name="id172">关于插件</a>
</h1><div class="para"><div>
　Susie-Plugin或扩展PCM可播放格式的插件，或其他插件，必须使用<a id="id173" name="id173" class="targanchor"><dfn>loadplugin</dfn></a>标签指定才能使用。<br />
<br />
　例如，要使用wuvorbis.dll，需要写：<br />
<br />

<br />
<code class="bq">@loadplugin&nbsp;module=wuvorbis.dll<br />
</code>
<br />

<br />
　插件必须放在以下位置之一：<ul><li>与吉里吉里可执行文件（krkr.eXe）相同的位置</li><li>可执行文件所在文件夹下的<a id="id174" name="id174" class="targanchor"><dfn>plugin文件夹</dfn></a></li><li>项目文件夹</li></ul>　如果放在项目文件夹中，在使用Releaser时会被包含在档案或可执行文件中，但<em>不推荐这样做</em>。最好不要包含在档案中，而是与主程序放在同一文件夹中分发（包含在档案中时，直接从CD-ROM运行等情况下可能会出错）。<br />
<br />
　krmovie.dll和krflash.dll不是插件，所以不需要用loadplugin标签指定。<br />
<br />
　也请参阅吉里吉里SDK帮助中的"关于插件"。<br />
<br /><div class="note"><div class="notehead"><span class="noteheadspan">Note</span></div>
　在吉里吉里1中，只要将插件放在与可执行文件相同的位置就能使用，但在吉里吉里2中，需要明确指定插件。<br />
</div><br />
</div></div>
<h1><a id="id175" name="id175">对UNICODE的支持</a>
</h1><div class="para"><div>
　编辑剧本文件和TJS脚本需要文本编辑器。<br />
　通常使用您常用的文本编辑器就没问题，但吉里吉里输出的控制台日志文件和KAG的保存数据是以UNICODE输出的，所以如果想编辑UNICODE文本，需要支持UNICODE的文本编辑器。<br />
　另外，如果想在剧本文件或TJS脚本中使用日语字符（这里的日语字符指日语版Windows通常可用的字符）以外的字符，需要以UNICODE文本编写这些文件。<br />
<br />
　显示日语以外的语言有几个条件：<br />
<br />
<ul><li>相关剧本文件或TJS脚本文件以UNICODE编写（UNICODE文本文件和非UNICODE文本文件可以混合使用）</li><li>如果不使用预渲染字体文件，则玩家的OS必须是Windows NT系列（Windows 2000、Windows XP、Vista以后）（使用预渲染字体文件时玩家的OS无关紧要）</li><li>指定包含要显示语言字符的字体</li><li>要显示的语言是从左到右书写（横排）或从上到下书写（竖排）的语言</li></ul><br />
　在任何情况下，日语以外的字符只能显示在游戏屏幕内，窗口标题栏或菜单项等使用Windows标准用户界面的部分只能显示日语字符。另外，通过edit标签生成的编辑框只能输入日语字符。<br />
<br />
<br /><div class="note"><div class="notehead"><span class="noteheadspan">Note</span></div>
　上面提到日语字符，但基本上吉里吉里遵循其运行的OS的语言区域设置（如日语版Windows则为日语字符，中文版Windows则为中文等）。不过作者并未检查过。<br />
</div><br />
<br /><div class="note"><div class="notehead"><span class="noteheadspan">Note</span></div>
　目前吉里吉里/KAG仅在Windows上运行，所以暂时UNICODE指的是小端字节序的UTF-16（但不能使用代理对）。<br />
　此外，吉里吉里只有在UNICODE文本是小端字节序的UTF-16，并且文件开头有BOM（字节顺序标记）时才能正确识别字符编码（目前即使有正确的BOM，也不能读取大端字节序的UTF-16）。<br />
</div><br />
</div></div>
	<script type="text/javascript" charset="UTF-8" src="documentid.js" ></script>
	<script type="text/javascript" charset="UTF-8" src="postcontent.js" ></script>
</body>
</html>
