<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" lang="zh-CN">
<!-- generated by to_html.pl from Macro.xml -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>使用宏</title>
	<meta name="author" content="W.Dee" />
	<meta http-equiv="Content-Style-Type" content="text/css" />
	<meta http-equiv="Content-Script-Type" content="text/javascript" />
	<link href="browser.css" type="text/css" rel="stylesheet" title="吉里吉里相关参考用标准样式" />
	<link href="mailto:dee@kikyou.info" rev="Made" />
	<link href="index.html" target="_top" rel="Start" title="首页" />
</head>
<body>
<h1><a id="id114" name="id114">什么是宏</a>
</h1><div class="para"><div>
　宏是"使用一个标签表示多个标签或文本"的工具。<br />
<br />
　它是将现有标签或文本组合起来，自由定义新标签的方法。<br />
　在KAG中，可能会有许多场景需要重复指定相同的标签，但使用宏功能可以大幅减少这类工作。<br />
　对于常规的标签序列，将其宏化以便轻松使用吧<code class="inlinecode">(^^)</code><br />
</div></div>
<h1><a id="id115" name="id115">基本用法</a>
</h1><div class="para"><div>
　要使用宏，首先必须"定义"宏。宏只需定义一次，之后就可以多次使用。因此，定义宏时最好放在first.ks的开头等位置。<br />
<br />
　定义宏时，使用<a id="id116" name="id116" class="targanchor"><dfn>macro</dfn></a>标签和<a id="id117" name="id117" class="targanchor"><dfn>endmacro</dfn></a>标签将要制作成宏的部分括起来。macro标签的name属性指定宏名。<br />
<br />

<br />
<code class="bq">[wait&nbsp;time=200]<br />
*start|开始<br />
[cm]<br />
;&nbsp;--&nbsp;宏的定义&nbsp;--<br />
<em>[macro&nbsp;name=newtag]</em>[font&nbsp;color=0xff0000]这样来创建宏[resetfont]<em>[endmacro]</em><br />
</code>
<br />

<br />
要使用它时，只需像使用标签一样使用宏名。<br />

<br />
<code class="bq">;&nbsp;--&nbsp;使用宏&nbsp;--<br />
[newtag]<br />
</code>
<br />

<br />
　执行这段代码时，<code class="inlinecode">[newtag]</code>处会被替换为<code class="inlinecode">[font color=0xff0000]这样来创建宏[resetfont]</code>，因此会显示红色文字"这样来创建宏"。<br />
<br />
　也可以写成多行。<br />
<br />

<br />
<code class="bq">[wait&nbsp;time=200]<br />
*start|开始<br />
[cm]<br />
;&nbsp;--&nbsp;宏的定义&nbsp;--<br />
[macro&nbsp;name=newtag]<br />
[font&nbsp;color=0xff0000]<br />
这样来创建宏<br />
[resetfont]<br />
[endmacro]<br />
</code>
<br />


<br />
<code class="bq">;&nbsp;--&nbsp;使用宏&nbsp;--<br />
[newtag]<br />
</code>
<br />

</div></div>
<h1><a id="id118" name="id118">宏的属性</a>
</h1><div class="para"><div>
　可以给宏添加属性，并在宏中替换这些属性。<br />
　在宏中，如果属性值以<a id="id119" name="id119" class="targanchor"><dfn>%</dfn></a>开头，它将被替换为传递给宏的属性。<br />
　请看下面的例子。<br />

<br />
<code class="bq">[wait&nbsp;time=200]<br />
*start|开始<br />
[cm]<br />
;&nbsp;--&nbsp;宏的定义&nbsp;--<br />
[macro&nbsp;name=newtag]<br />
[font&nbsp;color=<em>%iro</em>]<br />
这样来创建宏<br />
[resetfont]<br />
[endmacro]<br />
</code>
<br />


<br />
<code class="bq">;&nbsp;--&nbsp;使用宏&nbsp;--<br />
[newtag&nbsp;<em>iro=0x00ff00</em>]<br />
</code>
<br />

<br />
　在这个例子中，我们提供了iro属性，通过实体将其替换为font标签的color属性。<br />
　执行时，将以绿色文字显示"这样来创建宏"。<br />
<br />
<br />
　此外，如果在宏中标签的属性指定为<a id="id120" name="id120" class="targanchor"><dfn>*</dfn></a>，可以传递所有传递给宏的属性。例如，如果想创建一个在trans标签后添加wt标签的宏，可以这样写：<br />
<br />

<br />
<code class="bq">[macro&nbsp;name=transwait][trans&nbsp;<em>*</em>][wt][endmacro]<br />
</code>
<br />

<br />
　这样，当使用transwait宏时，指定给transwait宏的所有属性都会原封不动地传递给trans标签，这对创建在现有标签基础上稍作修改的宏非常方便。<br />
<br />
　宏中的宏会再次展开，所以请注意不要在宏中写入自己的宏(^^)<br />
<br />
　如果想为省略的值指定默认值，可以在带%的属性后添加<a id="id121" name="id121" class="targanchor"><dfn>|</dfn></a>（竖线），然后指定省略时的值。请看下面的例子。<br />
<br />

<br />
<code class="bq">[wait&nbsp;time=200]<br />
*start|开始<br />
[cm]<br />
;&nbsp;--&nbsp;宏的定义&nbsp;--<br />
[macro&nbsp;name=newtag]<br />
[font&nbsp;color=%color<em>|0xff0000</em>]<br />
这样来创建宏<br />
[resetfont]<br />
[endmacro]<br />
</code>
<br />


<br />
<code class="bq">;&nbsp;--&nbsp;使用宏&nbsp;--<br />
[newtag&nbsp;color=0x00ff00]<br />
[newtag]<br />
</code>
<br />

　在第一个使用[newtag]的地方，由于指定了color属性，所以会被替换为其值0x00ff00，文字以绿色显示。<br />
　在第二个使用[newtag]的地方，由于没有指定任何属性，所以采用默认值"0xff0000"，文字以红色显示。<br />
<br />
<br /><div class="note"><div class="notehead"><span class="noteheadspan">注意</span></div>
　请使用英文半角小写字母指定属性名。使用大写字母可能导致无法正常工作。</div><br />
</div></div>
	<script type="text/javascript" charset="UTF-8" src="documentid.js" ></script>
	<script type="text/javascript" charset="UTF-8" src="postcontent.js" ></script>
</body>
</html>
