<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" lang="zh-CN">
<!-- generated by to_html.pl from PortFromOldKAG.xml -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>从KAG 3以下版本的移植和KAG 3的新功能</title>
	<meta name="author" content="W.Dee" />
	<meta http-equiv="Content-Style-Type" content="text/css" />
	<meta http-equiv="Content-Script-Type" content="text/javascript" />
	<link href="browser.css" type="text/css" rel="stylesheet" title="吉里吉里相关参考用标准样式" />
	<link href="mailto:dee@kikyou.info" rev="Made" />
	<link href="index.html" target="_top" rel="Start" title="首页" />
</head>
<body>
<h1><a id="id127" name="id127">关于从KAG 3以下版本的移植</a>
</h1><div class="para"><div>
　KAG 3是对之前的KAG重新编写的版本，在剧本级别上兼容，但也存在细微差异。<br />
　最大的变化是剧本文件中的换行被忽略了，但可以通过将Config.tjs中的<code class="inlinecode">global.ignoreCR</code>设置为<code class="inlinecode">false</code>来使其与旧版KAG行为相同。<br />
　此外，quake标签的time属性在KAG 3中单位变为毫秒。如果要使用KAG 3以下版本的字符数单位，请在Config.tjs中将<code class="inlinecode">defaultQuakeTimeInChUnit</code>设置为<code class="inlinecode">true</code>。<br />
<br />
　与KAG 3以下版本相比，文字显示更大一些。请尝试指定较小的字体。<br />
<br />
　保存数据的存储位置，默认为可执行文件所在文件夹下的savedata文件夹，请注意。<br />
<br />
　标签也有一些差异。<br />
<ul>  <li>emb标签没有zenkaku属性</li>  <li>playvideo的usesound属性已废弃</li>  <li>clearsysvar仅清除系统变量</li></ul><br />
　可能还有其他标签的运行方式不同，但这很可能是KAG 3的bug。如有异常请向作者报告。<br />
　关于插件处理的差异，请参阅<a target="main" class="jump" href="Prepare.html">准备工作</a>中的"关于插件"部分。<br />
</div></div>
<h1><a id="id128" name="id128">KAG 3的新功能</a>
</h1><div class="para"><div>
<dl>
<dt>KAG的剧本解析部分内置到吉里吉里2本体</dt>
<dd>　吉里吉里2本体内置了解析KAG剧本的功能。KAG 2.x使用TJS脚本处理，通过将其内置到本体中，剧本解析速度得到了飞跃性提高。</dd>
<dt>几乎所有标签都可以使用cond属性</dt>
<dd>　cond属性可用于几乎所有标签，通过cond="表达式"指定的表达式为真时，才会执行该标签。例如，<br />

<br />
<code class="bq">[jump&nbsp;cond=&quot;f.flag1==0&quot;&nbsp;target=*loop]<br />
</code>
<br />

表示只有当f.flag1为0时，才会跳转到*loop标签。</dd>
<dt>动画信息文件从asq变为asd</dt>
<dd>　改为更通用的asd格式。发布文件中的asq2asd是将asq文件转换为asd文件的脚本。关于asd文件的描述，请参考AnimationLayer.tjs文件。<br />
　此外，使用称为动画片段的方法，可以对一个图像同时执行多个动画。</dd>
<dt>消息历史可以纵向显示</dt>
<dd>　除了横向显示外，现在还可以纵向显示。在Config.tjs中设置。</dd>
<dt>保存数据可以加密</dt>
<dd>　现在可以对保存数据进行简单加密。在Config.tjs中设置。</dd>
<dt>支持UNICODE文件</dt>
<dd>　吉里吉里2输出的文本文件基本上是UNICODE（UTF-16）。<br />
　保存数据等以UNICODE格式输出。准备一个能处理UNICODE的文本编辑器会很方便。<br />
　此外，现在可以读取UNICODE格式的文本文件（如KAG剧本）到吉里吉里2中。</dd>
<dt>正式支持MPEG视频格式</dt>
<dd>　现在可以播放MPEG视频。也可以播放存放在归档内的MPEG文件。<br />
　但是，要播放视频，需要将吉里吉里2本体附带的krmovie.dll放在与吉里吉里2本体相同的文件夹中。<br />
　此外，播放视频需要操作系统安装DirectX8或更高版本（推荐DirectX9或更高版本）。</dd>
<dt>支持预渲染字体</dt>
<dd>　通过使用预渲染字体，可以避免因操作系统或环境不同导致的字体差异和字间距问题。此外，由于使用创建者环境中的字体数据，可以使用玩家环境中没有的字体或外字。<br />
　创建预渲染字体需要使用krkrfont.exe。</dd></dl></div></div>
	<script type="text/javascript" charset="UTF-8" src="documentid.js" ></script>
	<script type="text/javascript" charset="UTF-8" src="postcontent.js" ></script>
</body>
</html>
