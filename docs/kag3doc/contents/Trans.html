<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" lang="zh-CN">
<!-- generated by to_html.pl from Trans.xml -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>使用转场效果</title>
	<meta name="author" content="W.Dee" />
	<meta http-equiv="Content-Style-Type" content="text/css" />
	<meta http-equiv="Content-Script-Type" content="text/javascript" />
	<link href="browser.css" type="text/css" rel="stylesheet" title="吉里吉里相关参考用标准样式" />
	<link href="mailto:dee@kikyou.info" rev="Made" />
	<link href="index.html" target="_top" rel="Start" title="首页" />
</head>
<body>
<h1><a id="id286" name="id286">在此之前</a>
</h1><div class="para"><div>
　淡入淡出、百叶窗等随时间变化的画面切换效果被称为<a id="id287" name="id287" class="targanchor"><dfn>转场效果</dfn></a>(过渡)。<br />
　在吉里吉里/KAG中，可以使用交叉淡入淡出转场、通用转场和滚动转场这三种类型的转场效果。<br />
　此外，使用扩展转场插件（extrans.dll）可以使用更多的转场效果（请参阅吉里吉里SDK帮助中的"关于转场效果"）。<br />
</div></div>
<h1><a id="id288" name="id288">交叉淡入淡出转场</a>
</h1><div class="para"><div>
　交叉淡入淡出转场是一种简单的画面切换效果。<br />
　由于是过渡效果，所以需要转场前的图像和转场后的图像。在KAG中，转场前的图像是表页的图层，转场后的图像是里页的图层。也就是说，里页的图层图像会转移到表页。<br />
　随着转场的开始，表页的图像会随着时间逐渐被里页的图像替换，最终里页的图像会成为表页的图像。<br />
<br />
<br /><div class="note"><div class="notehead"><span class="noteheadspan">Note</span></div>
　KAG中没有<a id="id289" name="id289" class="targanchor"><dfn>淡出</dfn></a>、<a id="id290" name="id290" class="targanchor"><dfn>淡入</dfn></a>的概念。如果想要淡出到黑色，需要将里页设置为全黑状态，然后进行交叉淡入淡出转场。</div><br />
</div></div>
<h1><a id="id291" name="id291">通用转场</a>
</h1><div class="para"><div>
　通用转场是指通用（普遍适用的）转场（过渡），可以自由创建所谓的"画面切换效果"。<br />
<br />
　此外，通用转场需要使用称为<a id="id292" name="id292" class="targanchor"><dfn>规则图像</dfn></a>的灰度图像。如果规则图像的大小小于要进行转场的图层，则会自动平铺使用。这个图像作为"规则"来进行转场效果。<br />
　通用转场需要的属性包括<a id="id293" name="id293" class="targanchor"><dfn>time</dfn></a>（执行转场的时间）和<a id="id294" name="id294" class="targanchor"><dfn>vague</dfn></a>（<a id="id295" name="id295" class="targanchor"><dfn>模糊区域值</dfn></a>）。<br />
<br />
　下面举个例子。<br />
<br />
　请看下面的图像。<br />
<br /><div class="descimg"><img width="64" height="64" alt="univtrans_A.png" src="univtrans_A.png" /><img width="64" height="64" alt="univtrans_B.png" src="univtrans_B.png" /><img width="64" height="64" alt="univtrans_R.png" src="univtrans_R.png" /><br />转场前、转场后、规则图像</div><br /><br />
　这样，带有字母A的图像将变成带有字母B的图像。规则图像使用简单的从上到下、从黑到白的渐变图像。<br />
<br />
　首先，将<a id="id296" name="id296" class="targanchor"><dfn>vague</dfn></a>（模糊区域值）设为1时，转场效果将如下进行。从左到右进行。为了方便起见，这里将过渡效果并排展示，但实际上这些是在同一位置连续显示的。<br />
<br /><div class="descimg"><img width="320" height="64" alt="univtrans_V1.png" src="univtrans_V1.png" /><br />vague=1 时</div><br /><br />
　也就是说，从规则图像中的黑色部分开始，朝着白色部分，逐渐被B图像替换。<br />
<br />
　现在让我们设定vague=64试试。<br />
<br /><div class="descimg"><img width="320" height="64" alt="univtrans_V64.png" src="univtrans_V64.png" /><br />vague=64 时</div><br />　这次，A图像和B图像的边界变得模糊了，对吧？通过增加vague值，可以在过渡过程中增加既不是A也不是B的模糊部分。vague可以指定1以上的数值。<br />
<br />
　规则图像不仅可以使用这种简单的渐变，还可以指定各种图案，从而实现自由的转场效果。<br />
<br />
　吉里吉里下载页面<a target="_top" class="jump" href="http://kikyou.info/tvp/">http://kikyou.info/tvp/</a>上发布了"<a id="id297" name="id297" class="targanchor"><dfn>转场效果库</dfn></a>"，其中包含20多种通用转场规则图像。<br />
</div></div>
<h1><a id="id298" name="id298">滚动转场</a>
</h1><div class="para"><div>
　滚动转场与通用转场不同，它是让切换源（里画面）的图像滚动进入切换目标（表画面）图像区域内的效果。<br />
　切换源（里画面）图像可以从左、上、右、下四个方向进入。<br />
　此外，滚动方式有三种类型。<br />
<br />
　首先，当<a id="id299" name="id299" class="targanchor"><dfn>stay</dfn></a>属性指定为"stayfore"时，滚动转场效果如下（从下方进入的情况）。<br />
<br /><div class="descimg"><img width="320" height="64" alt="univtrans_Sstay.png" src="univtrans_Sstay.png" /><br />stay=stayfore 时</div><br />　这样，当stay属性指定为"stayfore"时，表页图像保持在原位不动，里页从外部移动进入的感觉。<br />
<br />
　另外，当stay属性指定为"stayback"时，滚动转场效果如下。<br />
<br /><div class="descimg"><img width="320" height="64" alt="univtrans_Sstaysrc.png" src="univtrans_Sstaysrc.png" /><br />stay=stayback 时</div><br />　在这种情况下，表页图层移出后，里页图层从后面显现出来的感觉。<br />
<br />
　当stay属性指定为"nostay"时，效果如下。<br />
<br /><div class="descimg"><img width="320" height="64" alt="univtrans_Snostay.png" src="univtrans_Snostay.png" /><br />stay=nostay</div><br />　这样，进入的切换源图像会像推动一样使滚动源图像移出。如果将A图像和B图像水平或垂直连续放置，可以产生大屏幕滚动的效果。但这种效果不太适合前景图层的切换<code class="inlinecode">(^^;;</code><br />
</div></div>
<h1><a id="id300" name="id300">表页和里页</a>
</h1><div class="para"><div>
　在执行转场时，<a id="id301" name="id301" class="targanchor"><dfn>表页</dfn></a>和<a id="id302" name="id302" class="targanchor"><dfn>里页</dfn></a>的概念非常重要。<br />
　正如在<a target="main" class="jump" href="DispBase.html">显示背景</a>中介绍的那样，KAG有平时可见的表页和不可见的里页，除了可见性不同外，两者的结构完全相同。<br />
　KAG的转场总是朝着这个方向进行：当前显示的表页内容逐渐被里页内容取代。转场结束后，表页内容将完全与里页内容相同。<br />
　因此，在转场前必须操作里页。<br />
<br />
　举例说明。考虑只替换背景图层的情况。<br />
　首先，转场前，图层状态如下（左为表，右为里）<br />
<br />
<br /><div class="descimg"><img width="240" height="180" alt="trans0f.jpg" src="trans0f.jpg" /><img width="240" height="180" alt="trans0b.jpg" src="trans0b.jpg" /><br />转场前</div><br />　此时表页显示背景图层、全景图层和消息图层。里页可以是任何状态。<br />
　在这里使用[backlay]标签使里页与表页相同。<br />
<br /><div class="descimg"><img width="240" height="180" alt="trans0f.jpg" src="trans0f.jpg" /><img width="240" height="180" alt="trans0f.jpg" src="trans0f.jpg" /><br />backlay标签执行后</div><br />　由于转场是将里页内容移到表页，所以在执行转场前需要调整里页。<br />
　这里只想替换背景图层，所以在里页的背景图层上加载图像。<br />
<br /><div class="descimg"><img width="240" height="180" alt="trans0f.jpg" src="trans0f.jpg" /><img width="240" height="180" alt="trans2b.jpg" src="trans2b.jpg" /><br />加载里页背景图层图像后</div><br />　现在终于可以用trans标签执行转场了。再次强调，转场是将里页图像带到表页。<br />
　转场中状态如下（转场示例）。<br />
<br /><div class="descimg"><img width="240" height="180" alt="trans3f.jpg" src="trans3f.jpg" /><img width="240" height="180" alt="trans2b.jpg" src="trans2b.jpg" /><br />转场中</div><br />　使用[wt]标签等待转场完成。<br />
　转场完成后，表页和里页将变为相同状态。<br />
<br /><div class="descimg"><img width="240" height="180" alt="trans2b.jpg" src="trans2b.jpg" /><img width="240" height="180" alt="trans2b.jpg" src="trans2b.jpg" /><br />转场后</div><br /></div></div>
<h1><a id="id303" name="id303">尝试切换背景图层</a>
</h1><div class="para"><div>
　要执行转场，使用<a id="id304" name="id304" class="targanchor"><dfn>trans</dfn></a>标签。<br />
　基本上，转场是通过[<a id="id305" name="id305" class="targanchor"><dfn>backlay</dfn></a>]标签将所有表页图层信息复制到里页，然后在里页修改需要变化的部分（如使用image标签），然后用trans标签执行转场。这样，应用于里页的变化就会替换当前表页并应用到表页。<br />
<br />
　首先，让我们尝试用交叉淡入淡出转场切换背景图层。<br />
<br />

<br />
<code class="bq">[image&nbsp;storage=&quot;bg0&quot;&nbsp;page=fore&nbsp;layer=base]<br />
[wait&nbsp;time=200]<br />
*start|开始<br />
[cm]<br />
你好。现在切换背景图层。[l][r]<br />
<em>[backlay]</em><br />
[image&nbsp;storage=&quot;bg1&quot;&nbsp;layer=base&nbsp;<em>page=back</em>]<br />
<em>[trans&nbsp;method=crossfade&nbsp;time=1500]</em><br />
<em>[wt]</em><br />
切换了吗？<br />
</code>
<br />

　首先，用[backlay]标签将表页图层信息复制到里页。<br />
　然后，在里页的背景图层上加载下一个要显示的图像。<br />
　此时，里页与表页的区别只在于背景图像。<br />
　接下来用trans标签执行转场。像这样，在trans属性中指定<code class="inlinecode">method=crossfade</code>就是交叉淡入淡出转场。这个例子中时间指定为1.5秒。时间以毫秒为单位指定，所以使用<code class="inlinecode">time=1500</code>。<br />
<br /><div class="note"><div class="notehead"><span class="noteheadspan">Note</span></div>
　虽然以毫秒为单位指定，但实际精度并不一定达到毫秒级。</div><br />
<br />
　然后，用<a id="id306" name="id306" class="targanchor"><dfn>wt</dfn></a>标签等待转场结束。<em>KAG如果不写wt标签会不等待转场结束就继续执行</em>，所以请不要忘记wt标签。<br />
<br /><div class="note"><div class="notehead"><span class="noteheadspan">Note</span></div>
　不仅是转场，KAG中大多数"需要时间处理的"标签本身不会等待结束，而是有单独的等待结束的标签。这使得可以同时执行多个操作，比如在转场的同时淡出BGM。<br />
　另外，<em>请务必编写对应的"等待"标签</em>。即使是用不同类型的标签等待（如用wait标签等待转场结束），也应该写上正确对应的"等待"标签。<br />
</div><br />
<br />
<br />
　如果使用通用转场，效果如下：<br />

<br />
<code class="bq">[image&nbsp;storage=&quot;bg0&quot;&nbsp;page=fore&nbsp;layer=base]<br />
[wait&nbsp;time=200]<br />
*start|开始<br />
[cm]<br />
你好。现在切换背景图层。[l][r]<br />
<em>[backlay]</em><br />
[image&nbsp;storage=&quot;bg1&quot;&nbsp;layer=base&nbsp;<em>page=back</em>]<br />
<em>[trans&nbsp;method=universal&nbsp;rule=&quot;rule1&quot;&nbsp;vague=1&nbsp;time=1500]</em><br />
<em>[wt]</em><br />
切换了吗？<br />
</code>
<br />

<br />
　这个例子中也是用trans标签执行转场。像这样，在trans属性中指定<code class="inlinecode">method=universal</code>就是通用转场（即使省略method属性也会被视为universal）。在这个例子中，规则图像是"rule1"，时间是1.5秒，模糊区域值是1。<br />
<br />
　另外，如果要使用滚动转场，从右侧进入，无停留，效果如下：<br />
<br />

<br />
<code class="bq">[image&nbsp;storage=&quot;bg0&quot;&nbsp;page=fore&nbsp;layer=base]<br />
[wait&nbsp;time=200]<br />
*start|开始<br />
[cm]<br />
你好。现在切换背景图层。[l][r]<br />
[backlay]<br />
[image&nbsp;storage=&quot;bg1&quot;&nbsp;layer=base&nbsp;<em>page=back</em>]<br />
[trans&nbsp;<em>method=scroll&nbsp;from=right&nbsp;stay=nostay&nbsp;children=false</em>&nbsp;time=1500]<br />
[wt]<br />
切换了吗？<br />
</code>
<br />

　在这里指定<code class="inlinecode">children=false</code>是因为如果不这样指定，"<a id="id307" name="id307" class="targanchor"><dfn>子图层</dfn></a>"也会一起移动。在KAG中，背景图层是父层，前景图层和消息图层是背景图层的子层。<br />
　如果希望子图层也一起滚动，可以设置<code class="inlinecode">children=true</code>。<br />
</div></div>
<h1><a id="id308" name="id308">尝试切换前景图层</a>
</h1><div class="para"><div>
　切换前景图层也使用trans标签。<br />
<br />

<br />
<code class="bq">[image&nbsp;storage=&quot;bg0&quot;&nbsp;page=fore&nbsp;layer=base]<br />
[wait&nbsp;time=200]<br />
*start|开始<br />
[cm]<br />
你好。现在使用转场效果显示前景图层。[l][r]<br />
[backlay]<br />
[image&nbsp;layer=0&nbsp;page=back&nbsp;storage=&quot;fg0&quot;&nbsp;visible=true]<br />
;&nbsp;此时，表页的前景图层0是（默认情况下）不可见的，<br />
;&nbsp;此时，里页的前景图层0是可见的并且持有图像，<br />
;&nbsp;其他里页图层因backlay标签的作用，与表页完全相同<br />
[trans&nbsp;method=crossfade&nbsp;time=1500][wt]<br />
接下来，切换前景图层。[l][r]<br />
[backlay]<br />
[image&nbsp;layer=0&nbsp;page=back&nbsp;storage=&quot;fg1&quot;&nbsp;visible=true]<br />
;&nbsp;此时，里页的前景图层0是fg1图像，<br />
;&nbsp;其他里页图层因backlay标签的作用，与表页完全相同<br />
[trans&nbsp;method=crossfade&nbsp;time=1500][wt]<br />
然后，移除前景图层。[l][r]<br />
[backlay]<br />
[layopt&nbsp;layer=0&nbsp;page=back&nbsp;visible=false]<br />
;&nbsp;此时，里页的前景图层0是不可见的，<br />
;&nbsp;其他里页图层因backlay标签的作用，与表页完全相同<br />
[trans&nbsp;method=crossfade&nbsp;time=1500][wt]<br />
</code>
<br />

　上面的例子是显示前景图层，然后替换为另一个图像，最后将其移除。<br />
　首先，在显示部分，使用backlay标签将表页信息全部复制到里页。然后，修改需要变更的部分，这里是想显示前景图层，所以在里页的前景图层上加载图像。<br />
　之后，使用trans标签。<br />
<br />
　接下来切换前景图层，这也是在用backlay复制到里页后，操作需要修改的部分，然后用trans标签执行转场。<br />
<br />
　最后移除前景图层，同样是用backlay复制到里页后，将相应的前景图层设为不可见。不可见就意味着不显示（这是很明显的），执行转场后图层就会消失。<br />
<br />
　在此过程中，您可能会担心为里页的图层指定了visible=true是否会导致它显示出来，但里页（背景图层及其子图层）本身只能是不可见的，所以即使指定visible=true也不用担心会显示出来。<br />
<br />
<br /><div class="note"><div class="notehead"><span class="noteheadspan">Note</span></div>
　如上例所示，省略trans标签的layer属性时，会被视为指定了base（背景图层），省略children属性时，会被视为指定了true（与子图层一起转场）。<br />
　当想使用转场显示前景图层、替换前景图层、移除前景图层等各种转场效果时，关键是对背景图层及其所有子图层一起执行转场。虽然也可以通过指定layer=0等方式对前景图层或消息图层单独执行转场，但通常不这样使用。<br />
</div><br />
</div></div>
<h1><a id="id309" name="id309">尝试切换消息图层</a>
</h1><div class="para"><div>
　消息图层也可以用类似的方法切换。<br />
　对于消息图层，可以用layopt标签控制显示和隐藏，所以可以执行类似的操作。<br />
<br />
　例如，要在消息图层不可见的情况下绘制内容，然后用转场效果显示在屏幕上，可以这样做。另外，之后还演示了如何用转场效果隐藏消息图层。<br />
<br />

<br />
<code class="bq">[layopt&nbsp;layer=message&nbsp;page=fore&nbsp;visible=false]<br />
;&nbsp;↑最初将表页消息图层设为不可见<br />
[layopt&nbsp;layer=message&nbsp;page=back&nbsp;visible=true]<br />
;&nbsp;↑将里页消息图层设为可见状态<br />
[wait&nbsp;time=200]<br />
*start|开始<br />
[cm]<br />
[current&nbsp;page=back]<br />
;&nbsp;↑将操作对象设为里页消息图层<br />
[delay&nbsp;speed=nowait]<br />
;&nbsp;↑文字显示速度设为无等待<br />
这样可以在使用转场效果的同时显示消息图层。[r]<br />
[delay&nbsp;speed=user]<br />
;&nbsp;↑文字显示速度恢复原设置<br />
[trans&nbsp;method=universal&nbsp;rule=&quot;trans1&quot;&nbsp;vague=1&nbsp;time=1500][wt]<br />
;&nbsp;↑通用转场<br />
[current&nbsp;page=fore]<br />
;&nbsp;↑为保险起见，将操作对象恢复为表页消息图层<br />
[l]<br />
;&nbsp;↑等待点击<br />
[layopt&nbsp;layer=message&nbsp;page=back&nbsp;visible=false]<br />
;&nbsp;↑将里页消息图层设为不可见<br />
[trans&nbsp;method=universal&nbsp;rule=&quot;trans1&quot;&nbsp;vague=1&nbsp;time=1500][wt]<br />
;&nbsp;↑转场<br />
</code>
<br />

</div></div>
	<script type="text/javascript" charset="UTF-8" src="documentid.js" ></script>
	<script type="text/javascript" charset="UTF-8" src="postcontent.js" ></script>
</body>
</html>
