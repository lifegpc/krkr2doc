<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" lang="zh-CN">
<!-- generated by to_html.pl from RClick.xml -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>关于右键点击子程序</title>
	<meta name="author" content="W.Dee" />
	<meta http-equiv="Content-Style-Type" content="text/css" />
	<meta http-equiv="Content-Script-Type" content="text/javascript" />
	<link href="browser.css" type="text/css" rel="stylesheet" title="吉里吉里相关参考用标准样式" />
	<link href="mailto:dee@kikyou.info" rev="Made" />
	<link href="index.html" target="_top" rel="Start" title="首页" />
</head>
<body>
<h1><a id="id176" name="id176">什么是右键点击子程序</a>
</h1><div class="para"><div>
　鼠标右键点击时调用的KAG子程序。<br />
　用于通过右键点击显示保存/加载画面等功能。<br />
</div></div>
<h1><a id="id177" name="id177">简单示例</a>
</h1><div class="para"><div>
　创建右键点击子程序需要使用rclick标签。通过此标签，可以指定在右键点击时调用指定的子程序，或者跳转到指定的标签。<br />
<br />
　例如，在rlick.ks中写入以下内容：<br />

<br />
<code class="bq"><span class="weak">例:</span><br />*rclick<br />
@rclick&nbsp;jump=true&nbsp;storage=&quot;rclick.ks&quot;&nbsp;target=&quot;*exit&quot;&nbsp;enabled=true<br />
@current&nbsp;layer=message1<br />
@layopt&nbsp;layer=message0&nbsp;page=fore&nbsp;visible=false<br />
@layopt&nbsp;layer=message1&nbsp;page=fore&nbsp;visible=true<br />
@er<br />
这里是右键点击程序内部。<br />
[s]<br />
<br />
*exit<br />
@layopt&nbsp;layer=message1&nbsp;page=fore&nbsp;visible=false<br />
@layopt&nbsp;layer=message0&nbsp;page=fore&nbsp;visible=true<br />
@current&nbsp;layer=message0<br />
@rclick&nbsp;call=true&nbsp;storage=&quot;rclick.ks&quot;&nbsp;target=&quot;*rclick&quot;&nbsp;enabled=true<br />
@return<br />
</code>
<br />

　然后，在first.ks中添加以下行：
<br />
<code class="bq">@rclick&nbsp;call=true&nbsp;storage=&quot;rclick.ks&quot;&nbsp;target=&quot;*rclick&quot;&nbsp;enabled=true<br />
</code>
<br />

<br />
　这样，右键点击时就会调用rclick.ks中的*rclick。<br />
　在上面的rclick.ks示例中，首先设置了右键点击时跳转到*exit。这样，在右键点击子程序内部点击右键就可以返回原处。<br />
　隐藏了消息层0。这样即使消息层0上显示有选项，也无法选择。<br />
　显示消息层1，在其中显示"这里是右键点击程序内部。"，然后停止。<br />
</div></div>
<h1><a id="id178" name="id178">复杂示例</a>
</h1><div class="para"><div>
　下面是一个较为复杂的右键点击子程序示例，它可以查看消息历史记录、进行保存和读取等操作。
<br />
<code class="bq"><span class="weak">例:</span><br />*sub1<br />
@tempsave<br />
;&nbsp;↑临时保存状态<br />
@history&nbsp;output=false<br />
;&nbsp;↑禁止输出到消息历史记录<br />
@mapdisable&nbsp;layer=0&nbsp;page=fore<br />
;&nbsp;↑如果使用了可点击地图则这样禁用它<br />
@backlay<br />
@layopt&nbsp;layer=message1&nbsp;page=back&nbsp;visible=true<br />
;&nbsp;↑在此子程序中使用消息层1<br />
@layopt&nbsp;layer=message0&nbsp;page=back&nbsp;visible=false<br />
@current&nbsp;layer=message1&nbsp;page=back<br />
@position&nbsp;left=0&nbsp;top=0&nbsp;width=640&nbsp;height=480<br />
@eval&nbsp;exp=&quot;f.r_first=true&quot;<br />
;&nbsp;↑仅在进入此程序时执行转场效果<br />
;<br />
*menu<br />
@er<br />
@nowait<br />
[link&nbsp;target=*hide]隐藏消息[endlink][r]<br />
[link&nbsp;target=*history]查看消息历史[endlink][r]<br />
[link&nbsp;target=*load]加载书签[endlink][r]<br />
[link&nbsp;target=*save]保存书签[endlink][r]<br />
[link&nbsp;target=*gotostart]返回开始[endlink][r]<br />
[link&nbsp;target=*ret]返回[endlink][r]<br />
@endnowait<br />
@current&nbsp;layer=message1&nbsp;page=fore<br />
@if&nbsp;exp=&quot;f.r_first&quot;<br />
@trans&nbsp;time=500&nbsp;rule=trans1&nbsp;vague=128<br />
@wt<br />
@endif<br />
@eval&nbsp;exp=&quot;f.r_first=false&quot;<br />
@s<br />
<br />
*ret<br />
;&nbsp;从子程序返回<br />
@tempload&nbsp;bgm=false&nbsp;se=false&nbsp;backlay=true<br />
@trans&nbsp;time=500&nbsp;rule=trans1&nbsp;vague=128<br />
@wt<br />
@return<br />
<br />
*hide<br />
;&nbsp;隐藏消息<br />
@hidemessage<br />
@jump&nbsp;target=*menu<br />
<br />
*history<br />
;&nbsp;查看消息历史<br />
@showhistory<br />
@jump&nbsp;target=*menu<br />
<br />
*load<br />
;&nbsp;加载书签<br />
;&nbsp;关于emb&nbsp;exp=&nbsp;....&nbsp;请参考&nbsp;<a target="main" class="jump" href="TJSTips.html">更多使用TJS的方法</a><br />
@er<br />
@nowait<br />
[link&nbsp;target=*lt0][emb&nbsp;exp=&quot;kag.getBookMarkPageName(0)&quot;][endlink][r]<br />
[link&nbsp;target=*lt1][emb&nbsp;exp=&quot;kag.getBookMarkPageName(1)&quot;][endlink][r]<br />
[link&nbsp;target=*lt2][emb&nbsp;exp=&quot;kag.getBookMarkPageName(2)&quot;][endlink][r]<br />
[link&nbsp;target=*lt3][emb&nbsp;exp=&quot;kag.getBookMarkPageName(3)&quot;][endlink][r]<br />
[link&nbsp;target=*lt4][emb&nbsp;exp=&quot;kag.getBookMarkPageName(4)&quot;][endlink][r]<br />
[link&nbsp;target=*menu]返回[endlink][r]<br />
@endnowait<br />
@s<br />
<br />
*lt0<br />
@load&nbsp;place=0&nbsp;ask=true<br />
@jump&nbsp;target=*menu<br />
*lt1<br />
@load&nbsp;place=1&nbsp;ask=true<br />
@jump&nbsp;target=*menu<br />
*lt2<br />
@load&nbsp;place=2&nbsp;ask=true<br />
@jump&nbsp;target=*menu<br />
*lt3<br />
@load&nbsp;place=3&nbsp;ask=true<br />
@jump&nbsp;target=*menu<br />
*lt4<br />
@load&nbsp;place=4&nbsp;ask=true<br />
@jump&nbsp;target=*menu<br />
<br />
*save<br />
;&nbsp;保存书签<br />
;&nbsp;关于emb&nbsp;exp=&nbsp;....&nbsp;请参考&nbsp;<a target="main" class="jump" href="TJSTips.html">更多使用TJS的方法</a><br />
@er<br />
@nowait<br />
[link&nbsp;target=*st0][emb&nbsp;exp=&quot;kag.getBookMarkPageName(0)&quot;][endlink][r]<br />
[link&nbsp;target=*st1][emb&nbsp;exp=&quot;kag.getBookMarkPageName(1)&quot;][endlink][r]<br />
[link&nbsp;target=*st2][emb&nbsp;exp=&quot;kag.getBookMarkPageName(2)&quot;][endlink][r]<br />
[link&nbsp;target=*st3][emb&nbsp;exp=&quot;kag.getBookMarkPageName(3)&quot;][endlink][r]<br />
[link&nbsp;target=*st4][emb&nbsp;exp=&quot;kag.getBookMarkPageName(4)&quot;][endlink][r]<br />
[link&nbsp;target=*menu]返回[endlink][r]<br />
@endnowait<br />
@s<br />
<br />
*st0<br />
@save&nbsp;place=0&nbsp;ask=true<br />
@jump&nbsp;target=*menu<br />
*st1<br />
@save&nbsp;place=1&nbsp;ask=true<br />
@jump&nbsp;target=*menu<br />
*st2<br />
@save&nbsp;place=2&nbsp;ask=true<br />
@jump&nbsp;target=*menu<br />
*st3<br />
@save&nbsp;place=3&nbsp;ask=true<br />
@jump&nbsp;target=*menu<br />
*st4<br />
@save&nbsp;place=4&nbsp;ask=true<br />
@jump&nbsp;target=*menu<br />
<br />
<br />
*gotostart<br />
;&nbsp;"返回开始"<br />
@gotostart&nbsp;ask=true<br />
@jump&nbsp;target=*menu<br />
</code>
<br />

<br />
　此外，在书签数据中保存缩略图时需要注意一些事项，请参考locksnapshot和unlocksnapshot标签。<br />
</div></div>
	<script type="text/javascript" charset="UTF-8" src="documentid.js" ></script>
	<script type="text/javascript" charset="UTF-8" src="postcontent.js" ></script>
</body>
</html>
