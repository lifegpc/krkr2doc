<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" lang="zh-CN">
<!-- generated by to_html.pl from pp.xml -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>预处理器</title>
	<meta name="author" content="W.Dee" />
	<meta http-equiv="Content-Style-Type" content="text/css" />
	<meta http-equiv="Content-Script-Type" content="text/javascript" />
	<link href="browser.css" type="text/css" rel="stylesheet" title="吉里吉里相关参考用标准样式" />
	<link href="mailto:dee@kikyou.info" rev="Made" />
	<link href="index.html" target="_top" rel="Start" title="首页" />
</head>
<body>
<h1><a id="id273" name="id273">预处理器</a>
</h1><div class="para"><div>
　TJS2 可以处理<a id="id274" name="id274" class="targanchor"><dfn>条件编译表达式</dfn></a>（对应于C语言中的#if和#endif）。这在脚本实际被解释之前进行处理，可以根据条件使脚本的部分不被解释或被解释。<br />
　条件编译表达式的风格与C的预处理器指令不同，采用自由风格，可以写在任何地方。不像C的指令那样，必须一行只写一条指令。<br />
</div></div>
<h1><a id="id275" name="id275">@set 指令</a>
</h1><div class="para"><div>
　@set 指令用于评估条件编译表达式，并丢弃结果。语法如下：
<br />
<code class="bq">&nbsp;&nbsp;&nbsp;&nbsp;@set(表达式)<br />
</code>
<br />

　在"表达式"中可以编写条件编译表达式。这里可以使用以下运算符：<br />

<br />
<code class="bq">&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;&nbsp;=&nbsp;&nbsp;!=&nbsp;&nbsp;==&nbsp;&nbsp;||&nbsp;&nbsp;&amp;&amp;&nbsp;&nbsp;|&nbsp;&nbsp;^&nbsp;&nbsp;&amp;&nbsp;&nbsp;&lt;&nbsp;&nbsp;&gt;&nbsp;&nbsp;&lt;=&nbsp;&nbsp;&gt;=&nbsp;&nbsp;+&nbsp;&nbsp;-&nbsp;&nbsp;%&nbsp;&nbsp;*&nbsp;&nbsp;/&nbsp;&nbsp;!&nbsp;&nbsp;+&nbsp;&nbsp;-&nbsp;&nbsp;(&nbsp;)<br />
</code>
<br />

　关于这些运算符的含义，请参见<a target="main" class="jump" href="expr_and_op.html">表达式和运算符</a>。但是，可处理的数据类型仅限于整数。<br />
　此外，可以使用任意变量和立即值。变量名称的命名规则与<a target="main" class="jump" href="token.html">标记</a>中变量的命名规则和立即值相同。<br />
　但是，预处理器中使用的变量和TJS2脚本中使用的变量不会相互干扰（不共享同一命名空间）。<br />
</div></div>
<h1><a id="id276" name="id276">@if 指令, @endif 指令</a>
</h1><div class="para"><div>
　@if 指令用于评估条件编译表达式，如果结果为0，则不解释到下一个@endif之间的内容。如果结果不为0，则进行解释。<br />
　语法如下：<br />

<br />
<code class="bq">&nbsp;&nbsp;&nbsp;&nbsp;@if(表达式)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@endif<br />
</code>
<br />

&nbsp;&nbsp;&nbsp;&nbsp;"表达式"中指定条件编译表达式。@if～@endif可以嵌套。<br />
<br />

<br />
<code class="bq"><span class="weak">例:</span><br />&nbsp;&nbsp;&nbsp;&nbsp;@if(flag==0)&nbsp;&nbsp;<span class="comment">//&nbsp;尚未赋值的变量被视为0</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@set(flag=1)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;****<br />
&nbsp;&nbsp;&nbsp;&nbsp;@endif<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;↑&nbsp;&nbsp;使****部分编写的脚本编译仅执行一次</span><br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;@if(version&gt;=0x02040009)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@if(flag)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;****<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@endif<br />
&nbsp;&nbsp;&nbsp;&nbsp;@endif&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;↑&nbsp;仅当version大于等于0x02040009（2.4.9）且flag不为0时才编译****部分</span><br />
</code>
<br />

</div></div>
<h1><a id="id277" name="id277">预定义变量</a>
</h1><div class="para"><div>
　<a id="id278" name="id278" class="targanchor"><dfn>version</dfn></a>变量表示当前TJS2的版本。<br />
<br />
　作为数值，以16进制表示为0x0XYYZZZZ的形式，其中X部分表示主版本号，YY部分表示次版本号，ZZZZ表示发布号。例如，0x02040009表示版本为2.4.9。</div></div>
	<script type="text/javascript" charset="UTF-8" src="documentid.js" ></script>
	<script type="text/javascript" charset="UTF-8" src="postcontent.js" ></script>
</body>
</html>
