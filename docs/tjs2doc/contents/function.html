<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" lang="zh-CN">
<!-- generated by to_html.pl from function.xml -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>函数</title>
	<meta name="author" content="W.Dee" />
	<meta http-equiv="Content-Style-Type" content="text/css" />
	<meta http-equiv="Content-Script-Type" content="text/javascript" />
	<link href="browser.css" type="text/css" rel="stylesheet" title="吉里吉里相关参考用标准样式" />
	<link href="mailto:dee@kikyou.info" rev="Made" />
	<link href="index.html" target="_top" rel="Start" title="首页" />
</head>
<body>
<h1><a id="id199" name="id199">函数</a>
</h1><div class="para"><div>
　TJS2 的函数与<a id="id200" name="id200" class="targanchor"><dfn>子程序</dfn></a>几乎是同义词。即使是不返回值的情况也被视为函数。<br />
　此外，特别是作为类或对象成员的函数被称为"<a id="id201" name="id201" class="targanchor"><dfn>方法</dfn></a>"。<br />
</div></div>
<h1><a id="id202" name="id202">函数的写法</a>
</h1><div class="para"><div>
　函数可以按以下格式编写：<br />

<br />
<code class="bq">&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;函数名&nbsp;(&nbsp;参数列表&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;函数内容<br />
&nbsp;&nbsp;&nbsp;&nbsp;}<br />
</code>
<br />

<br />
　首先，要定义函数，需要写<a id="id203" name="id203" class="targanchor"><dfn>function</dfn></a>。然后，写上函数的名称。使用这里写的名称就可以调用函数。<br />
　在函数内容中，可以描述函数内要执行的语句或块。<br />
<br />

<br />
<code class="bq"><span class="weak">例:</span><br />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;test(a)&nbsp;{&nbsp;System.inform(a);&nbsp;}<br />
&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;func(a,&nbsp;b,&nbsp;c,&nbsp;d)<br />
&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test(a);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test(b);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test(c);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test(d);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;a+b-c*d;<br />
&nbsp;&nbsp;&nbsp;&nbsp;}<br />
</code>
<br />

<br />
对函数使用 instanceof 运算符并带有 &quot;Function&quot; 时结果为真（在上述例子中，func instanceof &quot;Function&quot; 为真）。<br />
</div></div>
<h1><a id="id204" name="id204">函数的调用</a>
</h1><div class="para"><div>
　函数调用使用 <a id="id205" name="id205" class="targanchor"><dfn>( )</dfn></a> 运算符，如下所示：<br />
<code class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;函数名( 参数 )<br />
</code>&nbsp;&nbsp;&nbsp;&nbsp;如果没有参数，则为<code class="inlinecode">函数名( )</code>。参数可以指定表达式，多个参数时用逗号分隔。<br />

<br />
<code class="bq"><span class="weak">例:</span><br />&nbsp;&nbsp;&nbsp;&nbsp;func();<br />
&nbsp;&nbsp;&nbsp;&nbsp;func(1+2,&nbsp;1-2);<br />
&nbsp;&nbsp;&nbsp;&nbsp;func(func2());<br />
</code>
<br />

<br />
&nbsp;&nbsp;&nbsp;&nbsp;另外，如果不指定表达式而留空，则该部分被视为指定了void。<br />

<br />
<code class="bq"><span class="weak">例:</span><br />&nbsp;&nbsp;&nbsp;&nbsp;func(,1);&nbsp;<span class="comment">//&nbsp;被视为指定了void,&nbsp;1</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;func(,);&nbsp;<span class="comment">//&nbsp;被视为指定了void,&nbsp;void</span><br />
</code>
<br />

</div></div>
<h1><a id="id206" name="id206">参数列表</a>
</h1><div class="para"><div>
　在参数列表中，写入接收传递参数的变量名称。函数调用时传递的参数按顺序依次传递给变量。<br />

<br />
<code class="bq"><span class="weak">例:</span><br />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;test(a,&nbsp;b,&nbsp;c)<br />
&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;此时，a、b和c这三个变量可以使用，</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;并且已经分配了作为参数传递的3个参数。</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;如果调用test(1,&nbsp;2,&nbsp;3)，则a为1，</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;b为2，c为3。</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;}<br />
</code>
<br />

<br />
　这些参数是局部变量，一旦执行退出函数就无法访问。<br />
<br />
　在TJS2中，即使函数调用时提供的参数比声明的参数少或多，也不会出错（例外地，不是由TJS2编写的函数（实际上由C++等编写的函数）可能会报错）。如果提供的参数比声明的多，多出的部分会被忽略；如果少，缺少的变量会被传入void。<br />

<br />
<code class="bq"><span class="weak">例:</span><br />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;test(a,&nbsp;b)<br />
&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;如果调用test(1)，a为1，b为void。</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;如果调用test(1,2,3)，a为1，b为2，3被忽略</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;}<br />
</code>
<br />

<br />
　参数列表中的每个参数可以通过 = 后跟默认值（<a id="id207" name="id207" class="targanchor"><dfn>默认参数</dfn></a>）来指定。这意味着当指定void或提供的参数少于声明的参数时，将自动使用指定的值。<br />

<br />
<code class="bq"><span class="weak">例:</span><br />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;test(a&nbsp;=&nbsp;-1,&nbsp;b&nbsp;=&nbsp;1)<br />
&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;如果...</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;调用test()，则a=-1，b=1</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;调用test(5)，则a=5，b=1</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;调用test(void,void)，则a=-1，b=1</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;调用test(,4)，则a=-1，b=4</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;}<br />
</code>
<br />

<br />
　不需要接收参数的函数可以省略参数列表。<br />

<br />
<code class="bq"><span class="weak">例:</span><br />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;test<br />
&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;不接收参数的函数</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;}<br />
</code>
<br />

</div></div>
<h1><a id="id208" name="id208">表达式中的函数</a>
</h1><div class="para"><div>
　在表达式中使用function关键字，可以创建没有名称的函数，即表达式中的函数（<a id="id209" name="id209" class="targanchor"><dfn>匿名函数</dfn></a>）。<br />
　在这种情况下，省略函数名称。<br />

<br />
<code class="bq"><span class="weak">例:</span><br />&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;func&nbsp;=&nbsp;function(i)&nbsp;{&nbsp;return&nbsp;i*5;&nbsp;};<br />
&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;func2&nbsp;=&nbsp;function&nbsp;{&nbsp;System.inform(&quot;hoge&quot;);&nbsp;};<br />
&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;v&nbsp;=&nbsp;func();&nbsp;<span class="comment">//&nbsp;调用func</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;func2();&nbsp;<span class="comment">//&nbsp;调用func2</span><br />
</code>
<br />

</div></div>
<h1><a id="id210" name="id210">参数的省略</a>
</h1><div class="para"><div>
　在调用函数时，仅将 <a id="id211" name="id211" class="targanchor"><dfn>...</dfn></a> 作为参数写入，那么传递给调用表达式所在函数的参数将按原样传递给被调用的函数。即使更改了参数变量的内容，或者接收的参数不足，也会正确传递原始内容和参数数量。<br />

<br />
<code class="bq"><span class="weak">例:</span><br />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;test()<br />
&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test2(...);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;传递给test2的是传递给test的参数，保持传递时的</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;内容和数量</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;}<br />
</code>
<br />

</div></div>
<h1><a id="id212" name="id212">参数的数组转换</a>
</h1><div class="para"><div>
　可以将参数作为数组接收。要作为数组接收，在声明函数时给参数名加上'<a id="id213" name="id213" class="targanchor"><dfn>*</dfn></a>'。<br />

<br />
<code class="bq"><span class="weak">例:</span><br />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;func(args*)<br />
&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;args是一个包含传递给此函数的参数作为元素的数组</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;例如，如果调用func(1,&nbsp;2,&nbsp;3,&nbsp;4)，</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;args将包含4个元素，按顺序从头开始是1、2、3、4</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;}<br />
</code>
<br />

<br />
　也可以将从参数中途到最后的所有参数都作为数组接收。如果参数数量不足，数组将为空。<br />

<br />
<code class="bq"><span class="weak">例:</span><br />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;func(x,&nbsp;args*)<br />
&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;例如，如果调用func(1,&nbsp;2,&nbsp;3,&nbsp;4)，</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;x为1。而args包含3个元素，</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;按顺序从头开始是2、3、4。</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;如果调用func(1)，由于参数数量不足，</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;args将是一个没有元素的数组。</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;}<br />
</code>
<br />

　这在处理可变长度参数时非常方便。<br />
<br />
　也可以不指定参数名。在这种情况下，可以在后面描述的数组到参数的展开中，将其用作没有名称的*。<br />
</div></div>
<h1><a id="id214" name="id214">数组到参数的展开</a>
</h1><div class="para"><div>
　可以展开数组并将其作为参数传递给函数。在这种情况下，与参数的数组转换一样，在要展开的表达式后面添加'<a id="id215" name="id215" class="targanchor"><dfn>*</dfn></a>'来调用函数。使用'*'指定要展开的表达式必须表示一个数组。<br />

<br />
<code class="bq"><span class="weak">例:</span><br />&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;args&nbsp;=&nbsp;[1,&nbsp;2,&nbsp;3,&nbsp;4];<br />
&nbsp;&nbsp;&nbsp;&nbsp;func(args*);<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;由于args包含1、2、3、4这四个元素，</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;所以这与func(1,&nbsp;2,&nbsp;3,&nbsp;4);具有相同的含义。</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;func(0,&nbsp;args*,&nbsp;5);<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;像这样插入到参数中间也是可能的。</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;在这种情况下，相当于func(0,&nbsp;1,&nbsp;2,&nbsp;3,&nbsp;4,&nbsp;5);</span><br />
</code>
<br />

<br />
　如果不指定表达式，而只是在参数中简单地指定*，则可以直接将调用表达式所在函数声明时写的无名'*'所表示的参数传递给被调用的函数。
<br />
<code class="bq"><span class="weak">例:</span><br />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;func(func_array,&nbsp;*)<br />
&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;调用func_array指定的函数，</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;首先传递该函数在func_array中的位置，</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;然后原样传递传递给func的第2个及之后的参数</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(var&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;func_array.count;&nbsp;i++)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func_array[i](i,&nbsp;*);<br />
&nbsp;&nbsp;&nbsp;&nbsp;}<br />
</code>
<br />

<br />
　使用无名*的函数调用处理比使用命名数组更有效率。<br />

<br />
<code class="bq"><span class="weak">例:</span><br />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;func(ar*)&nbsp;{&nbsp;func2(ar*);&nbsp;}<br />
&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;func(*)&nbsp;{&nbsp;func2(*);&nbsp;}<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;上面两个具有完全相同的含义，但下面的例子更有效率</span><br />
</code>
<br />

<br />
　无名*与"参数的省略"具有相同的效果。以下两个函数声明具有相同的含义。<br />

<br />
<code class="bq"><span class="weak">例:</span><br />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;func()&nbsp;{&nbsp;func2(...);&nbsp;}<br />
&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;func(*)&nbsp;{&nbsp;func2(*);&nbsp;}<br />
</code>
<br />

</div></div>
	<script type="text/javascript" charset="UTF-8" src="documentid.js" ></script>
	<script type="text/javascript" charset="UTF-8" src="postcontent.js" ></script>
</body>
</html>
